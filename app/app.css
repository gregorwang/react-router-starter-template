@import "tailwindcss" source(".");
@custom-variant dark (&:where(.dark, .dark *));
@theme {
	--font-sans:
		"Manrope", "Noto Sans", ui-sans-serif, system-ui, sans-serif,
		"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
	--font-mono:
		"JetBrains Mono", ui-monospace, SFMono-Regular, SFMono-Regular,
		Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;

	/* Brand palette */
	--color-brand-50: #eff6ff;
	--color-brand-100: #dbeafe;
	--color-brand-200: #bfdbfe;
	--color-brand-300: #93c5fd;
	--color-brand-400: #60a5fa;
	--color-brand-500: #3b82f6;
	--color-brand-600: #2563eb;
	--color-brand-700: #1d4ed8;
	--color-brand-800: #1e40af;
	--color-brand-900: #1e3a8a;
	--color-brand-950: #172554;

	/* Secondary palette */
	--color-secondary-50: #f0fdfa;
	--color-secondary-100: #ccfbf1;
	--color-secondary-200: #99f6e4;
	--color-secondary-300: #5eead4;
	--color-secondary-400: #2dd4bf;
	--color-secondary-500: #14b8a6;
	--color-secondary-600: #0d9488;
	--color-secondary-700: #0f766e;
	--color-secondary-800: #115e59;
	--color-secondary-900: #134e4a;
	--color-secondary-950: #042f2e;

	/* Accent palette */
	--color-accent-50: #fffbeb;
	--color-accent-100: #fef3c7;
	--color-accent-200: #fde68a;
	--color-accent-300: #fcd34d;
	--color-accent-400: #fbbf24;
	--color-accent-500: #f59e0b;
	--color-accent-600: #d97706;
	--color-accent-700: #b45309;
	--color-accent-800: #92400e;
	--color-accent-900: #78350f;
	--color-accent-950: #451a03;

	/* Neutral palette */
	--color-neutral-50: #f8fafc;
	--color-neutral-100: #f1f5f9;
	--color-neutral-200: #e2e8f0;
	--color-neutral-300: #cbd5e1;
	--color-neutral-400: #94a3b8;
	--color-neutral-500: #64748b;
	--color-neutral-600: #475569;
	--color-neutral-700: #334155;
	--color-neutral-800: #1e293b;
	--color-neutral-900: #0f172a;
	--color-neutral-950: #020617;
}

html,
body {
	@apply bg-neutral-50 text-neutral-900 font-sans antialiased;
	color-scheme: light;
	background-image:
		radial-gradient(1200px circle at 8% -10%, rgba(59, 130, 246, 0.18), transparent 40%),
		radial-gradient(900px circle at 90% 0%, rgba(20, 184, 166, 0.14), transparent 45%);
	background-attachment: fixed;
}

html.dark {
	color-scheme: dark;
}

html.dark body {
	@apply bg-neutral-950 text-neutral-100;
	background-image:
		radial-gradient(1200px circle at 5% -10%, rgba(59, 130, 246, 0.22), transparent 45%),
		radial-gradient(900px circle at 90% 0%, rgba(20, 184, 166, 0.2), transparent 50%);
}

/* Markdown prose styles */
.prose {
	@apply text-neutral-900 dark:text-neutral-100;
}

.prose h1 {
	@apply text-2xl font-semibold tracking-tight mb-4 mt-6;
}

.prose h2 {
	@apply text-xl font-semibold tracking-tight mb-4 mt-6;
}

.prose h3 {
	@apply text-lg font-semibold tracking-tight mb-2 mt-4;
}

.prose p {
	@apply mb-4 leading-relaxed text-neutral-700 dark:text-neutral-200;
}

.prose ul,
.prose ol {
	@apply mb-4 pl-6 list-disc space-y-2;
}

.prose ol {
	@apply list-decimal;
}

.prose li {
	@apply ml-2;
}

.prose strong {
	@apply font-semibold text-neutral-900 dark:text-white;
}

.prose em {
	@apply italic;
}

.prose code {
	@apply px-2 py-1 bg-neutral-100 dark:bg-neutral-800 text-brand-700 dark:text-brand-300 rounded-md text-sm font-mono;
}

.prose pre {
	@apply mb-4 p-4 bg-neutral-900 dark:bg-neutral-950 rounded-xl overflow-x-auto border border-white/5;
}

.prose pre code {
	@apply bg-transparent text-neutral-100 dark:text-neutral-100 p-0;
}

.prose a {
	@apply text-brand-600 hover:text-brand-500 underline underline-offset-4;
}

.prose blockquote {
	@apply border-l-4 border-brand-200/70 dark:border-brand-900/60 pl-4 italic text-neutral-600 dark:text-neutral-300 mb-4 bg-white/60 dark:bg-neutral-900/60 rounded-lg py-4;
}

.prose hr {
	@apply my-6 border-neutral-200 dark:border-neutral-800;
}

.prose table {
	@apply w-full mb-4 border-collapse text-sm;
}

.prose th,
.prose td {
	@apply border border-neutral-200 dark:border-neutral-800 px-4 py-2 text-left;
}

.prose th {
	@apply bg-neutral-100/80 dark:bg-neutral-900/80 font-semibold text-neutral-700 dark:text-neutral-200;
}

/* Shiki code blocks */
.shiki {
	@apply rounded-xl overflow-x-auto border border-white/5;
}

.prose .md-code-block {
	@apply mb-4 overflow-hidden rounded-xl border border-neutral-200/80 dark:border-neutral-700/70 bg-neutral-50/90 dark:bg-neutral-950/85;
}

.prose .md-code-toolbar {
	@apply flex items-center justify-between gap-3 px-3 py-2 border-b border-neutral-200/80 dark:border-neutral-700/70 text-[11px] uppercase tracking-[0.12em] text-neutral-600 dark:text-neutral-300 bg-white/80 dark:bg-neutral-900/80;
}

.prose .md-code-lang {
	@apply font-semibold text-neutral-500 dark:text-neutral-300;
}

.prose .md-code-actions {
	@apply flex items-center gap-2;
}

.prose .md-code-btn {
	@apply text-[11px] normal-case px-2 py-1 rounded-md border border-neutral-200 dark:border-neutral-700 text-neutral-600 dark:text-neutral-300 hover:text-brand-600 dark:hover:text-brand-300 hover:border-brand-300 dark:hover:border-brand-500 transition-colors;
}

.prose .md-code-content.is-collapsed {
	display: none;
}

.prose .md-code-content > pre,
.prose .md-code-content > .shiki {
	@apply mb-0 rounded-none border-0;
}

/* Route progress bar */
.route-progress {
	position: fixed;
	top: 0;
	left: 0;
	right: 0;
	height: 3px;
	z-index: 50;
	opacity: 0;
	pointer-events: none;
	transition: opacity 200ms ease;
}

.route-progress.is-visible {
	opacity: 1;
}

.route-progress__bar {
	height: 100%;
	background: linear-gradient(
		90deg,
		var(--color-brand-500),
		var(--color-secondary-500),
		var(--color-accent-500)
	);
	box-shadow: 0 0 10px rgba(59, 130, 246, 0.45);
	transition: width 200ms ease;
}

/* Custom scrollbar */
::-webkit-scrollbar {
	@apply w-2 h-2;
}

::-webkit-scrollbar-track {
	@apply bg-neutral-100/80 dark:bg-neutral-900/80;
}

::-webkit-scrollbar-thumb {
	@apply bg-neutral-300 dark:bg-neutral-700 rounded-full;
}

::-webkit-scrollbar-thumb:hover {
	@apply bg-neutral-400 dark:bg-neutral-600;
}

.chat-scroll-container {
	scrollbar-gutter: stable;
	-webkit-overflow-scrolling: touch;
}

@supports (scrollbar-gutter: stable both-edges) {
	.chat-scroll-container {
		scrollbar-gutter: stable both-edges;
	}
}

.chat-main-panel {
	min-width: 0;
	width: 100%;
}

.chat-sidebar-panel {
	position: fixed;
	inset: 0 auto 0 0;
	z-index: 40;
	transform: translate3d(-100%, 0, 0);
	will-change: transform;
	touch-action: pan-y;
}

.chat-sidebar-panel.is-open {
	transform: translate3d(0, 0, 0);
}

.chat-message-scroll,
.prose pre,
.shiki {
	overflow-x: auto;
	-webkit-overflow-scrolling: touch;
	overscroll-behavior-x: contain;
}

.prose pre,
.shiki {
	max-width: 100%;
}

.prose pre code,
.shiki code {
	white-space: pre;
	overflow-wrap: normal;
	word-break: normal;
}

@media (max-width: 767px) {
	html,
	body {
		/* Avoid iOS/low-end jank from fixed background during viewport resize */
		background-attachment: scroll;
	}

	.chat-layout {
		width: 100%;
	}

	.chat-main-panel {
		flex: 1 1 100%;
	}

	.chat-scroll-container {
		scrollbar-gutter: auto;
	}

	.chat-sidebar-backdrop {
		backdrop-filter: blur(2px);
		-webkit-backdrop-filter: blur(2px);
	}
}

@media (min-width: 768px) {
	.chat-sidebar-panel {
		position: static;
		transform: translate3d(0, 0, 0);
	}
}
